<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Contable - conta_bd</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- AplicaciÃ³n Principal -->
    <div id="mainApp" class="container">
        <!-- Header con informaciÃ³n del usuario -->
        <div class="header">
            <div class="header-content">
                <h1>ğŸ¢ Sistema Contable - conta_bd</h1>
                <div class="user-info">
                    <span id="userName">Cargando...</span>
                    <button class="logout-btn" onclick="logout()">ğŸšª Cerrar SesiÃ³n</button>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showSection('dashboard')">ğŸ“Š Dashboard</button>
                <button class="nav-btn" onclick="showSection('movimientos')">â• Movimientos</button>
                <button class="nav-btn" onclick="showSection('cuentas')">ğŸ“‹ CatÃ¡logo</button>
                <button class="nav-btn" onclick="showSection('balance')">ğŸ“ˆ Balance General</button>
                <button class="nav-btn" onclick="showSection('balanza')">âš–ï¸ Balanza</button>
                <button class="nav-btn" onclick="showSection('diario')">ğŸ“– Libro Diario</button>
                <button class="nav-btn" onclick="showSection('mayor')">ğŸ“š Libro Mayor</button>
                <button class="nav-btn admin-only" onclick="showSection('usuarios')" style="display:none">ğŸ‘¥ Usuarios</button>
            </div>
        </div>

        <div class="content">
            <!-- SecciÃ³n Dashboard -->
            <div id="dashboard" class="section active">
                <h2>ğŸ“Š Dashboard</h2>
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-header">
                            <h3>ğŸ’° Total Activos</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalActivos">$0.00</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>ğŸ”´ Total Pasivos</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalPasivos">$0.00</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>ğŸŸ¢ Capital</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalCapital">$0.00</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>ğŸ“ Movimientos</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalMovimientos">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="recent-movements">
                    <h3>ğŸ•’ Movimientos Recientes</h3>
                    <div id="recentMovementsList"></div>
                </div>
            </div>

            <!-- SecciÃ³n Agregar Movimientos -->
            <div id="movimientos" class="section">
                <h2>â• Registrar Movimiento Contable</h2>
                <div class="alert" id="movimientosAlert"></div>
                
                <form id="movimientoForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fecha">ğŸ“… Fecha:</label>
                            <input type="date" id="fecha" name="fecha" required>
                        </div>
                        <div class="form-group">
                            <label for="referencia">ğŸ”– Referencia:</label>
                            <input type="text" id="referencia" name="referencia" placeholder="NÃºmero de factura, cheque, etc.">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="concepto">ğŸ“„ Concepto:</label>
                        <input type="text" id="concepto" name="concepto" required placeholder="DescripciÃ³n del movimiento contable">
                    </div>

                    <h3>ğŸ’¼ Cuentas del Movimiento</h3>
                    <div id="cuentasContainer">
                        <div class="cuenta-row">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>ğŸ“‹ Cuenta:</label>
                                    <select class="cuenta-select" required>
                                        <option value="">Seleccionar cuenta</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>â• Debe:</label>
                                    <input type="number" class="debe-input" step="0.01" min="0" placeholder="0.00">
                                </div>
                                <div class="form-group">
                                    <label>â– Haber:</label>
                                    <input type="number" class="haber-input" step="0.01" min="0" placeholder="0.00">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="agregarCuenta()">â• Agregar Cuenta</button>
                        <button type="button" class="btn btn-secondary" onclick="quitarCuenta()">â– Quitar Cuenta</button>
                        <div class="balance-info">
                            <span id="balanceInfo">Debe: $0.00 | Haber: $0.00 | Diferencia: $0.00</span>
                        </div>
                    </div>
                    
                    <div class="form-row full">
                        <button type="submit" class="btn btn-primary">ğŸ’¾ Registrar Movimiento</button>
                    </div>
                </form>
            </div>

            <!-- SecciÃ³n CatÃ¡logo de Cuentas -->
            <div id="cuentas" class="section">
                <div class="section-header">
                    <h2>ğŸ“‹ CatÃ¡logo de Cuentas</h2>
                    <button class="btn btn-primary contador-only" onclick="showCuentaModal()" style="display:none">â• Nueva Cuenta</button>
                </div>
                <div class="alert" id="cuentasAlert"></div>
                
                <div class="table-container">
                    <table id="cuentasTable">
                        <thead>
                            <tr>
                                <th>ğŸ“ CÃ³digo</th>
                                <th>ğŸ“„ Nombre</th>
                                <th>ğŸ“Š Tipo</th>
                                <th>ğŸ·ï¸ Subtipo</th>
                                <th>âš–ï¸ Naturaleza</th>
                                <th class="contador-only" style="display:none">âš™ï¸ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="cuentasBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SecciÃ³n Balance General -->
            <div id="balance" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>ğŸ“ˆ Balance General</h3>
                    <p class="balance-date" id="balanceDate"></p>
                </div>
                
                <div class="table-container">
                    <table id="balanceTable">
                        <thead>
                            <tr>
                                <th>ğŸ’° Activo</th>
                                <th>ğŸ’µ Importe</th>
                                <th>ğŸ”´ Pasivo</th>
                                <th>ğŸ’µ Importe</th>
                                <th>ğŸŸ¢ Capital</th>
                                <th>ğŸ’µ Importe</th>
                            </tr>
                        </thead>
                        <tbody id="balanceBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SecciÃ³n Balanza de ComprobaciÃ³n -->
            <div id="balanza" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>âš–ï¸ Balanza de ComprobaciÃ³n</h3>
                    <p class="balance-date" id="balanzaDate"></p>
                </div>
                
                <div class="table-container">
                    <table id="balanzaTable">
                        <thead>
                            <tr>
                                <th rowspan="2">ğŸ“‹ CUENTAS</th>
                                <th colspan="2">ğŸ“Š MOVIMIENTOS</th>
                                <th colspan="2">ğŸ’° SALDOS</th>
                            </tr>
                            <tr>
                                <th>â• Deudor</th>
                                <th>â– Acreedor</th>
                                <th>â• Deudor</th>
                                <th>â– Acreedor</th>
                            </tr>
                        </thead>
                        <tbody id="balanzaBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SecciÃ³n Libro Diario -->
            <div id="diario" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>ğŸ“– Libro Diario</h3>
                </div>
                <div id="diarioContent"></div>
            </div>

            <!-- SecciÃ³n Libro Mayor -->
            <div id="mayor" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>ğŸ“š Libro Mayor</h3>
                </div>
                <div id="mayorContent"></div>
            </div>

            <!-- SecciÃ³n Usuarios (Solo Admin) -->
            <div id="usuarios" class="section">
                <div class="section-header">
                    <h2>ğŸ‘¥ GestiÃ³n de Usuarios</h2>
                </div>
                <div class="alert" id="usuariosAlert"></div>
                
                <div class="table-container">
                    <table id="usuariosTable">
                        <thead>
                            <tr>
                                <th>ğŸ”‘ Usuario</th>
                                <th>ğŸ‘¤ Nombre</th>
                                <th>ğŸ“§ Email</th>
                                <th>ğŸ‘¨â€ğŸ’¼ Rol</th>
                                <th>âœ… Estado</th>
                                <th>ğŸ“… Registro</th>
                                <th>âš™ï¸ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usuariosBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para nueva cuenta -->
    <div id="cuentaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>â• Nueva Cuenta</h3>
                <span class="close" onclick="closeCuentaModal()">&times;</span>
            </div>
            <form id="nuevaCuentaForm">
                <div class="alert" id="cuentaModalAlert"></div>
                
                <div class="form-group">
                    <label for="modalCodigo">ğŸ“ CÃ³digo:</label>
                    <input type="text" id="modalCodigo" required placeholder="Ej: 1001">
                </div>
                
                <div class="form-group">
                    <label for="modalNombre">ğŸ“„ Nombre:</label>
                    <input type="text" id="modalNombre" required placeholder="Nombre de la cuenta">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalTipo">ğŸ“Š Tipo:</label>
                        <select id="modalTipo" required>
                            <option value="">Seleccionar</option>
                            <option value="Activo">Activo</option>
                            <option value="Pasivo">Pasivo</option>
                            <option value="Capital">Capital</option>
                            <option value="Ingreso">Ingreso</option>
                            <option value="Egreso">Egreso</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="modalNaturaleza">âš–ï¸ Naturaleza:</label>
                        <select id="modalNaturaleza" required>
                            <option value="">Seleccionar</option>
                            <option value="Deudora">Deudora</option>
                            <option value="Acreedora">Acreedora</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="modalSubtipo">ğŸ·ï¸ Subtipo:</label>
                    <input type="text" id="modalSubtipo" placeholder="Opcional">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeCuentaModal()">âŒ Cancelar</button>
                    <button type="submit" class="btn btn-primary">ğŸ’¾ Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>