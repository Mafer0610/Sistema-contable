<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Contable - conta_bd</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Aplicación Principal -->
    <div id="mainApp" class="container">
        <!-- Header con información del usuario -->
        <div class="header">
            <div class="header-content">
                <h1>🏢 Sistema Contable - conta_bd</h1>
                <div class="user-info">
                    <span id="userName">Cargando...</span>
                    <button class="logout-btn" onclick="logout()">🚪 Cerrar Sesión</button>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showSection('dashboard')">📊 Dashboard</button>
                <button class="nav-btn" onclick="showSection('movimientos')">➕ Movimientos</button>
                <button class="nav-btn" onclick="showSection('cuentas')">📋 Catálogo</button>
                <button class="nav-btn" onclick="showSection('balance')">📈 Balance General</button>
                <button class="nav-btn" onclick="showSection('balanza')">⚖️ Balanza</button>
                <button class="nav-btn" onclick="showSection('diario')">📖 Libro Diario</button>
                <button class="nav-btn" onclick="showSection('mayor')">📚 Libro Mayor</button>
                <button class="nav-btn admin-only" onclick="showSection('usuarios')" style="display:none">👥 Usuarios</button>
            </div>
        </div>

        <div class="content">
            <!-- Sección Dashboard -->
            <div id="dashboard" class="section active">
                <h2>📊 Dashboard</h2>
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-header">
                            <h3>💰 Total Activos</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalActivos">$0.00</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>🔴 Total Pasivos</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalPasivos">$0.00</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>🟢 Capital</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalCapital">$0.00</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>📝 Movimientos</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-number" id="totalMovimientos">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="recent-movements">
                    <h3>🕒 Movimientos Recientes</h3>
                    <div id="recentMovementsList"></div>
                </div>
            </div>

            <!-- Sección Agregar Movimientos -->
            <div id="movimientos" class="section">
                <h2>➕ Registrar Movimiento Contable</h2>
                <div class="alert" id="movimientosAlert"></div>
                
                <form id="movimientoForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fecha">📅 Fecha:</label>
                            <input type="date" id="fecha" name="fecha" required>
                        </div>
                        <div class="form-group">
                            <label for="referencia">🔖 Referencia:</label>
                            <input type="text" id="referencia" name="referencia" placeholder="Número de factura, cheque, etc.">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="concepto">📄 Concepto:</label>
                        <input type="text" id="concepto" name="concepto" required placeholder="Descripción del movimiento contable">
                    </div>

                    <h3>💼 Cuentas del Movimiento</h3>
                    <div id="cuentasContainer">
                        <div class="cuenta-row">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>📋 Cuenta:</label>
                                    <select class="cuenta-select" required>
                                        <option value="">Seleccionar cuenta</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>➕ Debe:</label>
                                    <input type="number" class="debe-input" step="0.01" min="0" placeholder="0.00">
                                </div>
                                <div class="form-group">
                                    <label>➖ Haber:</label>
                                    <input type="number" class="haber-input" step="0.01" min="0" placeholder="0.00">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="agregarCuenta()">➕ Agregar Cuenta</button>
                        <button type="button" class="btn btn-secondary" onclick="quitarCuenta()">➖ Quitar Cuenta</button>
                        <div class="balance-info">
                            <span id="balanceInfo">Debe: $0.00 | Haber: $0.00 | Diferencia: $0.00</span>
                        </div>
                    </div>
                    
                    <div class="form-row full">
                        <button type="submit" class="btn btn-primary">💾 Registrar Movimiento</button>
                    </div>
                </form>
            </div>

            <!-- Sección Catálogo de Cuentas -->
            <div id="cuentas" class="section">
                <div class="section-header">
                    <h2>📋 Catálogo de Cuentas</h2>
                    <button class="btn btn-primary contador-only" onclick="showCuentaModal()" style="display:none">➕ Nueva Cuenta</button>
                </div>
                <div class="alert" id="cuentasAlert"></div>
                
                <div class="table-container">
                    <table id="cuentasTable">
                        <thead>
                            <tr>
                                <th>📝 Código</th>
                                <th>📄 Nombre</th>
                                <th>📊 Tipo</th>
                                <th>🏷️ Subtipo</th>
                                <th>⚖️ Naturaleza</th>
                                <th class="contador-only" style="display:none">⚙️ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="cuentasBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Sección Balance General -->
            <div id="balance" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>📈 Balance General</h3>
                    <p class="balance-date" id="balanceDate"></p>
                </div>
                
                <div class="table-container">
                    <table id="balanceTable">
                        <thead>
                            <tr>
                                <th>💰 Activo</th>
                                <th>💵 Importe</th>
                                <th>🔴 Pasivo</th>
                                <th>💵 Importe</th>
                                <th>🟢 Capital</th>
                                <th>💵 Importe</th>
                            </tr>
                        </thead>
                        <tbody id="balanceBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Sección Balanza de Comprobación -->
            <div id="balanza" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>⚖️ Balanza de Comprobación</h3>
                    <p class="balance-date" id="balanzaDate"></p>
                </div>
                
                <div class="table-container">
                    <table id="balanzaTable">
                        <thead>
                            <tr>
                                <th rowspan="2">📋 CUENTAS</th>
                                <th colspan="2">📊 MOVIMIENTOS</th>
                                <th colspan="2">💰 SALDOS</th>
                            </tr>
                            <tr>
                                <th>➕ Deudor</th>
                                <th>➖ Acreedor</th>
                                <th>➕ Deudor</th>
                                <th>➖ Acreedor</th>
                            </tr>
                        </thead>
                        <tbody id="balanzaBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Sección Libro Diario -->
            <div id="diario" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>📖 Libro Diario</h3>
                </div>
                <div id="diarioContent"></div>
            </div>

            <!-- Sección Libro Mayor -->
            <div id="mayor" class="section">
                <div class="balance-header">
                    <h2>Sky Home S.A. de C.V.</h2>
                    <h3>📚 Libro Mayor</h3>
                </div>
                <div id="mayorContent"></div>
            </div>

            <!-- Sección Usuarios (Solo Admin) -->
            <div id="usuarios" class="section">
                <div class="section-header">
                    <h2>👥 Gestión de Usuarios</h2>
                </div>
                <div class="alert" id="usuariosAlert"></div>
                
                <div class="table-container">
                    <table id="usuariosTable">
                        <thead>
                            <tr>
                                <th>🔑 Usuario</th>
                                <th>👤 Nombre</th>
                                <th>📧 Email</th>
                                <th>👨‍💼 Rol</th>
                                <th>✅ Estado</th>
                                <th>📅 Registro</th>
                                <th>⚙️ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usuariosBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para nueva cuenta -->
    <div id="cuentaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>➕ Nueva Cuenta</h3>
                <span class="close" onclick="closeCuentaModal()">&times;</span>
            </div>
            <form id="nuevaCuentaForm">
                <div class="alert" id="cuentaModalAlert"></div>
                
                <div class="form-group">
                    <label for="modalCodigo">📝 Código:</label>
                    <input type="text" id="modalCodigo" required placeholder="Ej: 1001">
                </div>
                
                <div class="form-group">
                    <label for="modalNombre">📄 Nombre:</label>
                    <input type="text" id="modalNombre" required placeholder="Nombre de la cuenta">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalTipo">📊 Tipo:</label>
                        <select id="modalTipo" required>
                            <option value="">Seleccionar</option>
                            <option value="Activo">Activo</option>
                            <option value="Pasivo">Pasivo</option>
                            <option value="Capital">Capital</option>
                            <option value="Ingreso">Ingreso</option>
                            <option value="Egreso">Egreso</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="modalNaturaleza">⚖️ Naturaleza:</label>
                        <select id="modalNaturaleza" required>
                            <option value="">Seleccionar</option>
                            <option value="Deudora">Deudora</option>
                            <option value="Acreedora">Acreedora</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="modalSubtipo">🏷️ Subtipo:</label>
                    <input type="text" id="modalSubtipo" placeholder="Opcional">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeCuentaModal()">❌ Cancelar</button>
                    <button type="submit" class="btn btn-primary">💾 Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>