<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Balance General</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #b19cd9 0%, #c2a5db 50%, #d4b3e0 100%);
      min-height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .main-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      margin: 30px auto;
      padding: 40px;
      max-width: 1000px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .page-title {
      color: #6b46a3;
      font-weight: bold;
      font-size: 2.2rem;
      text-align: center;
      margin-bottom: 10px;
    }
    .company-info {
      text-align: center;
      color: #8e7cc3;
      margin-bottom: 30px;
      font-size: 1.1rem;
    }
    .btn-back {
      background: rgba(228, 165, 232, 0.8);
      color: #6b46a3;
      border: 2px solid #6b46a3;
      border-radius: 10px;
      padding: 10px 20px;
      font-weight: 600;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      margin-bottom: 20px;
    }
    .btn-back:hover {
      background: #6b46a3;
      color: white;
      text-decoration: none;
    }
    .balance-table {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      overflow: hidden;
      border: 2px solid #e4a5e8;
      margin-bottom: 20px;
    }
    .balance-table table {
      margin: 0;
    }
    .section-header {
      background: linear-gradient(135deg, #6b46a3, #8e7cc3);
      color: white;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 1.1rem;
    }
    .subsection-header {
      background: rgba(228, 165, 232, 0.6);
      color: #6b46a3;
      font-weight: 600;
      font-size: 1rem;
    }
    .account-row {
      background: rgba(255, 255, 255, 0.8);
      border-bottom: 1px solid #e4a5e8;
    }
    .account-row:hover {
      background: rgba(228, 165, 232, 0.2);
    }
    .total-row {
      background: rgba(107, 70, 163, 0.1);
      font-weight: bold;
      color: #6b46a3;
      border-top: 2px solid #6b46a3;
    }
    .grand-total {
      background: linear-gradient(135deg, #6b46a3, #8e7cc3);
      color: white;
      font-weight: bold;
      font-size: 1.1rem;
    }
    td, th {
      padding: 12px 15px;
      border: none;
    }
    .text-end {
      text-align: right;
    }
    .controls {
      text-align: center;
      margin-bottom: 30px;
    }
    .btn-generate {
      background: linear-gradient(135deg, #6b46a3, #8e7cc3);
      border: none;
      border-radius: 10px;
      padding: 12px 30px;
      font-size: 1rem;
      font-weight: 600;
      color: white;
      transition: all 0.3s ease;
      margin: 0 10px;
    }
    .btn-generate:hover {
      background: linear-gradient(135deg, #5a3a8a, #7a6bb0);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(107, 70, 163, 0.4);
    }
    .btn-print {
      background: rgba(228, 165, 232, 0.8);
      color: #6b46a3;
      border: 2px solid #6b46a3;
      border-radius: 10px;
      padding: 10px 25px;
      font-weight: 600;
      transition: all 0.3s ease;
      margin: 0 10px;
    }
    .btn-print:hover {
      background: #6b46a3;
      color: white;
    }
    .date-info {
      text-align: center;
      color: #8e7cc3;
      font-style: italic;
      margin-bottom: 20px;
    }
    @media print {
      body {
        background: white;
      }
      .main-container {
        background: white;
        box-shadow: none;
        border: none;
      }
      .btn-back, .controls {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <a href="panel.html" class="btn-back">← Volver al Panel</a>
    
    <h1 class="page-title">BALANCE GENERAL</h1>
    <div class="company-info">
      <strong>Sky Home S.A.</strong><br>
      Al <span id="fechaBalance"></span>
    </div>

    <div class="controls">
      <button id="generateBtn" class="btn-generate">Generar Balance</button>
      <button id="printBtn" class="btn-print" onclick="window.print()">Imprimir</button>
    </div>

    <div class="date-info">
      (Cifras expresadas en pesos mexicanos)
    </div>

    <!-- ACTIVO -->
    <div class="balance-table">
      <table class="table">
        <thead>
          <tr class="section-header">
            <th colspan="2">ACTIVO</th>
          </tr>
        </thead>
        <tbody id="activoBody">
          <!-- Contenido dinámico -->
        </tbody>
      </table>
    </div>

    <!-- PASIVO Y CAPITAL -->
    <div class="balance-table">
      <table class="table">
        <thead>
          <tr class="section-header">
            <th colspan="2">PASIVO Y CAPITAL</th>
          </tr>
        </thead>
        <tbody id="pasivoCapitalBody">
          <!-- Contenido dinámico -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Establecer fecha actual
    document.getElementById('fechaBalance').textContent = new Date().toLocaleDateString('es-MX', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });

    // Protege la página si no está logueado
    if (localStorage.getItem('loggedIn') !== 'true') {
      window.location.href = 'login.html';
    }

    // Datos de ejemplo basados en el documento PDF
    const cuentasBalance = {
      activo: {
        circulante: [
          { nombre: 'Caja', saldo: 23120.00 },
          { nombre: 'Banco', saldo: 67270.00 },
          { nombre: 'Inventario', saldo: 27000.00 },
          { nombre: 'IVA acreditable', saldo: 2200.00 },
          { nombre: 'Rentas pag. x anticipado', saldo: 9000.00 },
          { nombre: 'Papeleria y utiles', saldo: 3750.00 }
        ],
        fijo: [
          { nombre: 'Terreno', saldo: 2000000.00 },
          { nombre: 'Edificio', saldo: 3000000.00 },
          { nombre: 'Mobiliario', saldo: 23000.00 },
          { nombre: 'Equipo de computo', saldo: 22500.00 },
          { nombre: 'Equipo de transporte', saldo: 65000.00 }
        ]
      },
      pasivo: {
        cortoPlazo: [
          { nombre: 'Cuentas por pagar', saldo: 3480.00 },
          { nombre: 'Doc por pagar', saldo: 5220.00 },
          { nombre: 'IVA trasladado', saldo: 1440.00 },
          { nombre: 'Anticipo clientes', saldo: 9000.00 }
        ]
      },
      capital: [
        { nombre: 'Capital', saldo: 5185000.00 }
      ]
    };

    function generarBalance() {
      // Generar ACTIVO
      const activoBody = document.getElementById('activoBody');
      activoBody.innerHTML = '';

      // Activo Circulante
      activoBody.innerHTML += `
        <tr class="subsection-header">
          <td><strong>ACTIVO CIRCULANTE</strong></td>
          <td></td>
        </tr>
      `;

      let totalCirculante = 0;
      cuentasBalance.activo.circulante.forEach(cuenta => {
        totalCirculante += cuenta.saldo;
        activoBody.innerHTML += `
          <tr class="account-row">
            <td style="padding-left: 30px;">${cuenta.nombre}</td>
            <td class="text-end">$${cuenta.saldo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</td>
          </tr>
        `;
      });

      activoBody.innerHTML += `
        <tr class="total-row">
          <td><strong>Total Activo Circulante</strong></td>
          <td class="text-end"><strong>$${totalCirculante.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</strong></td>
        </tr>
      `;

      // Activo Fijo
      activoBody.innerHTML += `
        <tr class="subsection-header">
          <td><strong>ACTIVO FIJO</strong></td>
          <td></td>
        </tr>
      `;

      let totalFijo = 0;
      cuentasBalance.activo.fijo.forEach(cuenta => {
        totalFijo += cuenta.saldo;
        activoBody.innerHTML += `
          <tr class="account-row">
            <td style="padding-left: 30px;">${cuenta.nombre}</td>
            <td class="text-end">$${cuenta.saldo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</td>
          </tr>
        `;
      });

      activoBody.innerHTML += `
        <tr class="total-row">
          <td><strong>Total Activo Fijo</strong></td>
          <td class="text-end"><strong>$${totalFijo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</strong></td>
        </tr>
      `;

      const totalActivo = totalCirculante + totalFijo;
      activoBody.innerHTML += `
        <tr class="grand-total">
          <td><strong>TOTAL ACTIVO</strong></td>
          <td class="text-end"><strong>$${totalActivo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</strong></td>
        </tr>
      `;

      // Generar PASIVO Y CAPITAL
      const pasivoCapitalBody = document.getElementById('pasivoCapitalBody');
      pasivoCapitalBody.innerHTML = '';

      // Pasivo a Corto Plazo
      pasivoCapitalBody.innerHTML += `
        <tr class="subsection-header">
          <td><strong>PASIVO A CORTO PLAZO</strong></td>
          <td></td>
        </tr>
      `;

      let totalPasivo = 0;
      cuentasBalance.pasivo.cortoPlazo.forEach(cuenta => {
        totalPasivo += cuenta.saldo;
        pasivoCapitalBody.innerHTML += `
          <tr class="account-row">
            <td style="padding-left: 30px;">${cuenta.nombre}</td>
            <td class="text-end">$${cuenta.saldo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</td>
          </tr>
        `;
      });

      pasivoCapitalBody.innerHTML += `
        <tr class="total-row">
          <td><strong>Total Pasivo</strong></td>
          <td class="text-end"><strong>$${totalPasivo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</strong></td>
        </tr>
      `;

      // Capital
      pasivoCapitalBody.innerHTML += `
        <tr class="subsection-header">
          <td><strong>CAPITAL CONTABLE</strong></td>
          <td></td>
        </tr>
      `;

      let totalCapital = 0;
      cuentasBalance.capital.forEach(cuenta => {
        totalCapital += cuenta.saldo;
        pasivoCapitalBody.innerHTML += `
          <tr class="account-row">
            <td style="padding-left: 30px;">${cuenta.nombre}</td>
            <td class="text-end">$${cuenta.saldo.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</td>
          </tr>
        `;
      });

      pasivoCapitalBody.innerHTML += `
        <tr class="total-row">
          <td><strong>Total Capital</strong></td>
          <td class="text-end"><strong>$${totalCapital.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</strong></td>
        </tr>
      `;

      const totalPasivoCapital = totalPasivo + totalCapital;
      pasivoCapitalBody.innerHTML += `
        <tr class="grand-total">
          <td><strong>TOTAL PASIVO + CAPITAL</strong></td>
          <td class="text-end"><strong>$${totalPasivoCapital.toLocaleString('es-MX', { minimumFractionDigits: 2 })}</strong></td>
        </tr>
      `;
    }

    // Event listener para generar balance
    document.getElementById('generateBtn').addEventListener('click', generarBalance);

    // Generar balance al cargar la página
    document.addEventListener('DOMContentLoaded', generarBalance);
  </script>
</body>
</html>